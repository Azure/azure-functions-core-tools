steps:
- template: ci/sign-files.yml@eng
  parameters:
    displayName: 'Authenticode signing (dll)'
    folderPath: '$(Build.Repository.LocalPath)/artifacts/ToSign/Authenticode/'
    pattern: '*.dll, *.exe'
    signType: inline
    inlineOperation: |
      [
          {
            "KeyCode": "CP-230012",
            "OperationCode": "SigntoolSign",
            "Parameters": {
              "OpusName": "Microsoft",
              "OpusInfo": "http://www.microsoft.com",
              "FileDigest": "/fd \"SHA256\"",
              "PageHash": "/NPH",
              "TimeStamp": "/tr \"http://rfc3161.gtm.corp.microsoft.com/TSS/HttpTspServer\" /td sha256"
            },
            "ToolName": "sign",
            "ToolVersion": "1.0"
          },
          {
            "KeyCode": "CP-230012",
            "OperationCode": "SigntoolVerify",
            "Parameters": {},
            "ToolName": "sign",
            "ToolVersion": "1.0"
          }
      ]

- template: ci/sign-files.yml@eng
  parameters:
    displayName: 'Third party signing (dll)'
    folderPath: '$(Build.Repository.LocalPath)/artifacts/ToSign/ThirdParty/'
    pattern: '*.dll, *.exe'
    signType: inline
    inlineOperation: |
      [
        {
            "KeyCode": "CP-231522",
            "OperationCode": "SigntoolSign",
            "Parameters": {
                "OpusName": "Microsoft",
                "OpusInfo": "http://www.microsoft.com",
                "Append": "/as",
                "FileDigest": "/fd \"SHA256\"",
                "PageHash": "/NPH",
                "TimeStamp": "/tr \"http://rfc3161.gtm.corp.microsoft.com/TSS/HttpTspServer\" /td sha256"
            },
            "ToolName": "sign",
            "ToolVersion": "1.0"
        },
        {
            "KeyCode": "CP-231522",
            "OperationCode": "SigntoolVerify",
            "Parameters": {},
            "ToolName": "sign",
            "ToolVersion": "1.0"
        }
      ]

- template: ci/sign-files.yml@eng
  parameters:
    displayName: 'Mac signing'
    folderPath: '$(Build.Repository.LocalPath)/artifacts/ToSign/Mac/'
    pattern: '*.zip'
    signType: inline
    inlineOperation: |
      [
        {
            "KeyCode" : "CP-401337-Apple",
            "OperationCode" : "MacAppDeveloperSign",
            "Parameters" : {},
            "ToolName" : "sign",
            "ToolVersion" : "1.0"
        }
      ]